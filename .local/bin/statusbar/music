#!/bin/sh

info=$(mpc)
lines=$(wc -l <<< "$info")

# Only print stuff if there is an active song
if [ "$lines" -gt 1 ]; then
  title=$(echo "$info" | sed 1q)
  playing=$(grep "playing" <<< "$info" )
  if [ -z "$playing" ]; then
    status=^c$(xgetres critical)^
  fi

  status=${status}"ïŽµ $title"

  # dwmblocks can only print a set amount of characters.
  # also makes sure very long titles are not displayed in full
  if [ $(wc -c <<< "$status") -gt 44 ]; then
    status="${status:0:40}"
    printf "$(awk '{$1=$1};1' <<< "$status")..."
  else
    printf "$status"
  fi

  echo ^d^
fi
