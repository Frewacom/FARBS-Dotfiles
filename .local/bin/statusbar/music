#!/bin/sh

info=$(mpc)
lines=$(wc -l <<< "$info")

# Only print stuff if there is an active song
if [ "$lines" -gt 1 ]; then
  playing=$(grep "playing" <<< "$info" )
  title=$(echo "$info" | sed 1q)
  if [ -z "$playing" ]; then
    printf ^c$(xgetres critical)^
    printf " "
  else
    printf " "
  fi

  if [ $(wc -c <<< "$title") -gt 31 ]; then
    titleshort="${title:0:28}"
    printf "${titleshort%%*( )}..."
  else
    printf "$title"
  fi
  echo ^d^
fi
