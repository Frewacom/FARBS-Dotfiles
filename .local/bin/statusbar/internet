#!/bin/sh

case $BLOCK_BUTTON in
	1) $TERMINAL -e nmtui ;;
esac

INTERFACE=$(ls /sys/class/net | grep "\bw.*")
SSID=$(nmcli device show | grep "$INTERFACE" -m 1 -A 5 | grep GENERAL.CONNECTION: -m 1 | awk '{print $2}')
ECONNECTED=$(cat /sys/class/net/e*/operstate)
WCONNECTED=$(cat /sys/class/net/w*/operstate)
ECOLOR="#00ff00"
SIGNAL=$(grep "^\s*w" /proc/net/wireless | awk '{ print "", int($3 * 100 / 70) "%" }')

WSTATUS=$(printf "<span color='%s'>%s @ %s</span>" "$WAL_LIGHT" "$SIGNAL" "$SSID")
ESTATUS=$(printf "<span color='%s'>CONNECTED</span>" "$WAL_LIGHT")

[ "$WCONNECTED" = 'down' ] && WSTATUS="<span color='#ff2929'> DOWN</span>"
[ "$ECONNECTED" = 'down' ] && ESTATUS="<span color='#ff2929'>DOWN</span>"

printf "W:%s, E: %s" "$WSTATUS" "$ESTATUS"
