BIN_PATH=~/.dotfiles/.local/bin/ftools

# Since these files are created for every new user, we must delete them before
# attempting to symlink them from the dotfiles folder or it wont work, meaning everything will be fucked
rm ~/.bash_profile
rm ~/.bashrc

# At this point, we haven't set the PATH so none of our tools are available without full path
bash $BIN_PATH/symlink-dotfiles

# Install python packages
curl https://bootstrap.pypa.io/get-pip.py -o ~/get-pip.py
sudo python get-pip.py
rm ~/get-pip.py

sudo pip install pywal
sudo pip install wal-steam
sudo pip install requests
sudo pip install untangle

# Add support for python3 in vim (required by nvim)
pip3 install --user pynvim

# Install formatters for JS, HTML, CSS, JSON and Python (used in vim with vim-autoformat)
sudo pip install yapf
npm install -g js-beautify

# Theme grub
sudo sed -i 's+#GRUB_THEME="/path/to/gfxtheme"+GRUB_THEME="/boot/grub/themes/arch-silence/theme.txt"+g' /etc/default/grub

# Update the grub config to enable microcode updates automatically
sudo grub-mkconfig -o /boot/grub/grub.cfg

# Create rules for the firewall so that kdeconnect will work
sudo ufw allow 1714:1764/udp
sudo ufw allow 1714:1764/tcp
sudo ufw enable
sudo ufw reload

# Install spacemacs
git clone https://github.com/syl20bnr/spacemacs ~/.emacs.d

# Install the pywal themer ewal
git clone https://github.com/emacsmirror/ewal.git ~/Repos/ewal

# Install FARBS
git clone https://github.com/Frewacom/FARBS.git ~/Repos/FARBS

# Install Pywalfox
git clone https://github.com/Frewacom/Pywalfox.git ~/Repos/Pywalfox

# Run themer
bash $BIN_PATH/themer ~/.dotfiles/.local/share/wallpaper.png "post-setup"

rm ~/post-setup

# Update the remote url for the dotfile repo
cd ~/.dotfiles
git remote set-url origin git@github.com:Frewacom/FARBS-Dotfiles.git

cd ~/Repos/FARBS
git remote set-url origin git@github.com:Frewacom/FARBS.git

cd ~/Repos/Pywalfox
git remote set-url origin git@github.com:Frewacom/Pywalfox.git

CRON_PATH=~/.dotfiles/profiles/$(whoami)/my-crontab
if [ -f "$CRON_PATH" ]; then
crontab $CRON_PATH
fi

# Lockscreen after suspend
sudo systemctl enable betterlockscreen@$USER

echo "Log out and log back in again for changes to take effect"


