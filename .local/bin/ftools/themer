if [ $# -lt 1 ]; then
	echo "Usage: themer <path-to-file>"
	exit
fi

bash ~/.dotfiles/.local/bin/tools/setbg $1
if [ -z "$3" ]; then
    wal -i $1 --saturate 0.4
else
    wal -i $1 --saturate $3
fi

# Create new configs with updated values
BIN_PATH=~/.dotfiles/.local/bin/ftools
.  $BIN_PATH/make-wal-colors
$BIN_PATH/make-dunst-config
$BIN_PATH/make-i3-config
$BIN_PATH/make-ferdi-config

cp $1 ~/.config/wallpaper.png

if [ "$2" = "no-reload" ]; then
	exit
fi

if [ "$2" = "post-setup" ]; then
	exit
else
	# When running post-setup, these things have not been started, meaning there is no files to change just yet
	#$BIN_PATH/make-steam-config

	echo "To fully set the new theme we need to logout (It refreshes the i3bar with the new colors)"
	read -p "Exit now? (Y/n)" EXIT

	if [ "$EXIT" = "" ] || [ "$EXIT" = "Y" ]; then
		i3-msg exit
	fi
fi


